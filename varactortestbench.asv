close all
clear all
clc

frf=1;

fm=0.1;

nharm=5;

c0=0.1;

eps=0.1;

z0=1;

nlcap=OptNLCap('capacitance',c0,...
'mod_freq',fm,...
    'mod_depth',eps,...
    'mod_phase',0);

res=OptResistor('value',z0);


ftest=IMtones(frf,fm,nharm);

ABCD_tot=nlcap.seriesABCD(ftest)*res.shuntABCD(ftest);

vin=zeros(1,2*nharm+1);

vin(nharm+1)=1;

[a,b,c,d]=ABCD_split(ABCD_tot);

vout=inv(a)*(vin.');

iin=c\vout;

disp(vout)
